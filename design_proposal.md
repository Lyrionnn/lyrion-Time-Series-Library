# 手部抓握时间序列分类方案设计

## 1. 特征设计策略

### 1.1 多层次特征体系

**原始特征层（5维）**
- Thumb (WT), Index (WI), Middle (WM), Ring (WR), Pinky (WP)
- 物理意义：手指到手腕的距离，直接反映手部姿态

**运动学特征层（10维）**
- 速度特征：各手指距离变化率 ∂d/∂t
- 加速度特征：各手指运动加速度 ∂²d/∂t²
- 物理意义：反映运动的动态特性和变化趋势

**协调性特征层（1维）**
- 手部整体收缩度：mean(all_fingers_distance)
- 手指间协调性：手指间距离变化的相关性
- 物理意义：评估手部协调运动能力

**频域特征层（3维）**
- 主要频率成分：识别抓握的周期性
- 低/中/高频能量分布：分析运动的频谱特征
- 物理意义：捕捉周期性抓握模式

**总维度：约20维（相比原始5维有4倍提升）**

### 1.2 关键创新点

1. **抓握次数自动检测**：通过峰值检测算法替代人工计数
2. **运动质量量化**：平滑度（抖动程度）+ 协调性综合评分
3. **多时间尺度分析**：瞬时特征 + 统计特征 + 频域特征

## 2. 分类任务设计

### 2.1 主任务：健康状态分类
- **目标**：区分正常人(normal) vs 患者(jzb)
- **标签**：二分类 {0: 正常, 1: 患者}
- **评估指标**：准确率、敏感性、特异性、AUC

### 2.2 辅助任务1：抓握次数分类
- **目标**：根据抓握频率进行分级
- **标签**：三分类 {0: 低频≤2次, 1: 中频3-5次, 2: 高频>5次}
- **意义**：量化运动功能水平

### 2.3 辅助任务2：运动质量评估
- **目标**：评估手部运动的协调性和平滑度
- **标签**：三分类 {0: 差, 1: 中等, 2: 好}
- **意义**：细化功能评估维度

### 2.4 辅助任务3：抓握频率分析
- **目标**：基于时间序列分析的频率特征
- **标签**：连续值或分类 {低频, 中频, 高频}
- **意义**：从时域转换到频域的功能评估

## 3. 时间序列处理策略

### 3.1 数据预处理
```python
# 1. 长度标准化（避免过多nan值）
target_length = np.percentile(sequence_lengths, 95)  # 使用95%分位数

# 2. 平滑滤波（降噪）
from scipy.signal import savgol_filter
smoothed_data = savgol_filter(raw_data, window_length=5, polyorder=2)

# 3. 归一化
normalized_data = (data - data.mean(axis=0)) / data.std(axis=0)
```

### 3.2 滑动窗口策略
- **窗口大小**：60帧（约2秒，假设30fps）
- **滑动步长**：30帧（50%重叠）
- **优势**：增加样本数量，捕捉局部运动模式

### 3.3 数据增强策略
- **添加高斯噪声**：模拟测量误差
- **时间扭曲**：轻微的时间伸缩（±5%）
- **幅值缩放**：模拟个体差异（±10%）

## 4. 模型选择建议

### 4.1 推荐模型（按优先级）

**1. TimesNet（首选）**
- 优势：专门设计用于时间序列分类，能够捕捉多尺度时间模式
- 适用性：对手部运动的周期性和多维特征敏感

**2. iTransformer**
- 优势：反向Transformer架构，擅长多变量时间序列
- 适用性：能够建模手指间的复杂交互关系

**3. PatchTST**
- 优势：基于Patch的设计，计算效率高
- 适用性：适合较长时间序列的局部模式识别

**4. MICN**
- 优势：多尺度卷积网络，擅长捕捉局部特征
- 适用性：适合抓握动作的短期模式识别

### 4.2 集成学习策略
```python
# 多模型集成
models = ['TimesNet', 'iTransformer', 'PatchTST']
# 使用加权平均或者Stacking集成
```

## 5. 实验设计建议

### 5.1 渐进式实验流程

**阶段1：基线验证**
- 使用原始5维特征
- 简单的时间序列分类
- 建立性能基线

**阶段2：特征工程验证**
- 使用20维增强特征
- 对比基线性能提升
- 分析关键特征重要性

**阶段3：多任务学习**
- 同时训练多个分类任务
- 利用任务间的相关性
- 提升主任务性能

**阶段4：集成优化**
- 多模型集成
- 超参数优化
- 最终性能评估

### 5.2 评估指标体系

**分类性能**
- 准确率（Accuracy）
- 精确率（Precision）
- 召回率（Recall）
- F1-Score
- AUC-ROC

**临床相关性**
- 与人工统计抓握次数的相关性
- 与专业医师评估的一致性
- 不同患者群体的区分能力

### 5.3 实验验证策略

**交叉验证**
```python
# 分层交叉验证，确保各类别平衡
from sklearn.model_selection import StratifiedKFold
skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)
```

**留一交叉验证（针对小样本）**
```python
# 如果样本数量有限，使用LOOCV
from sklearn.model_selection import LeaveOneOut
loo = LeaveOneOut()
```

## 6. 实施路线图

### 第1周：数据理解与预处理
- 运行特征工程脚本，分析数据分布
- 处理数据质量问题（异常值、缺失值）
- 生成增强的.ts格式数据集

### 第2周：基线模型训练
- 使用原始特征训练TimesNet基线模型
- 评估基础分类性能
- 分析错误案例

### 第3周：特征工程优化
- 使用20维增强特征重新训练
- 特征重要性分析
- 特征选择优化

### 第4周：多模型对比
- 训练iTransformer、PatchTST等模型
- 性能对比分析
- 选择最优模型组合

### 第5周：集成学习与优化
- 多模型集成
- 超参数调优
- 最终性能评估

这个方案从数据的物理意义出发，设计了多层次的特征体系和多任务的分类框架，应该能够显著提升手部功能评估的自动化水平和准确性。